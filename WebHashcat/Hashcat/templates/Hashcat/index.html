{% extends "base.html" %}

{% block content %}
   <h1> Hashcat </h1> {{ session_list|length }} sessions

   <table class="table table-striped table-condensed">
      <tr>
         <td><b>Session</b></td>
         <td><b>Node</b></td>
         <td><b>Cracking type</b></td>
         <td><b>Status</b></td>
         <td><b>Cracked</b></td>
         <td><b>Progress</b></td>
         <td></td>
      </tr>
      {% for session in session_list %}
      <tr>
         <td><a href="{% url "Hashcat:session" session.node session.name %}">{{ session.name }}</a></td>
         <td>{{ session.node }}</td>
         <td>{{ session.crack_type|title }}</td>
         <td>{{ session.status }}</td>
         <td>{{ session.cracked }}%</td>
         <td>{{ session.progress }}%</td>
         <td>
            {% if session.status == "Not started" %}
            <a href="{% url "Hashcat:action" session.node session.name "start" %}"><button type="button" class="btn btn-primary btn-xs">Start</button><a/>
            {% elif session.status == "Running" %}
   <a href="{% url "Hashcat:action" session.node session.name "pause" %}"><button type="button" class="btn btn-primary btn-xs">Pause</button></a>
   <a href="{% url "Hashcat:action" session.node session.name "quit" %}"><button type="button" class="btn btn-primary btn-xs">Stop</button></a>
            {% elif session.status == "Paused" %}
            <a href="{% url "Hashcat:action" session.node session.name "resume" %}"><button type="button" class="btn btn-primary btn-xs">Resume</button></a>
            <a href="{% url "Hashcat:action" session.node session.name "quit" %}"><button type="button" class="btn btn-primary btn-xs">Stop</button></a>
            {% else %}
            <a href="{% url "Hashcat:remove" session.node session.name %}"><button type="button" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>Remove</button><a/>
            {% endif %}
         </td>
      </tr>
      {% endfor %}
   </table>
   </br>
   <button type="button" class="btn btn-primary btn-xs" data-toggle="modal" data-target="#action_new">New</button></td>

   <!-- Modal -->
   <div class="modal fade" id="action_new" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
     <div class="modal-dialog modal-lg" role="document">
       <div class="modal-content">
         <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
           <h4 class="modal-title" id="myModalLabel">New session</h4>
         </div>

            <div class="modal-body">
               <!-- Nav tabs -->
               <ul class="nav nav-tabs" role="tablist">
                  <li class="active" ><a href="#rule_bruteforce" aria-controls="rule_bruteforce" role="tab" data-toggle="tab">Rule-based bruteforce</a></li>
                  <li><a href="#mask_bruteforce" aria-controls="mask_bruteforce" role="tab" data-toggle="tab">Mask-based bruteforce</a></li>
               </ul>

               <!-- Tab panes -->
               <div class="tab-content">
                  <div role="tabpanel" class="tab-pane active" id="rule_bruteforce">

                     <form action="{% url "Hashcat:new_session" %}" enctype="multipart/form-data" method="post">
                     {% csrf_token %}
                     <input type="hidden" id="crack_type" name="crack_type" value="rule">

                     <label for="name">Name</label>
                     <input type="text" class="form-control" id="name" name="name">
                     </br>

                     <label for="node">Node</label>
                     </br>
                     <select name="node" id="node">
                        {% for node in node_list %}
                        <option value="{{ node }}">{{ node }}</option>
                        {% endfor %}
                     </select>
                     </br>
                     </br>

                     <label for="hash_type">Hash type</label>
                     </br>
                     <select name="hash_type" id="hash_type">
                        {% for hash_type in hash_type_list %}
                        <option value="{{ hash_type.id }}">{{ hash_type.name }}</option>
                        {% endfor %}
                     </select>
                     </br>
                     </br>

                     <label for="rule">Rule</label>
                     </br>
                     <select name="rule" id="rule">
                        {% for rule in rule_list %}
                        <option value="{{ rule }}">{{ rule }}</option>
                        {% endfor %}
                     </select>
                     </br>
                     </br>

                     <label for="wordlist">Wordlist</label>
                     </br>
                     <select name="wordlist" id="wordlist">
                        {% for wordlist in wordlist_list %}
                        <option value="{{ wordlist }}">{{ wordlist }}</option>
                        {% endfor %}
                     </select>
                     </br>
                     </br>

                     <label for="hashes">Hashes</label>
                     </br>
                     <textarea name="hashes" id="hashes" rows="10" cols="60"></textarea>

                     <input type="file" name="hash_file" size="40">

                     <input type="checkbox" name="username_included" value="username_included">Username included
                     <br>
                     <br>
                     <button type="submit" class="btn btn-primary" >Crack</button>
                     </form>

                  </div>

                  <div role="tabpanel" class="tab-pane" id="mask_bruteforce">

                     <form action="{% url "Hashcat:new_session" %}" enctype="multipart/form-data" method="post">
                     {% csrf_token %}
                     <input type="hidden" id="crack_type" name="crack_type" value="mask">

                     <label for="name">Name</label>
                     <input type="text" class="form-control" id="name" name="name">
                     </br>

                     <label for="node">Node</label>
                     </br>
                     <select name="node" id="node">
                        {% for node in node_list %}
                        <option value="{{ node }}">{{ node }}</option>
                        {% endfor %}
                     </select>
                     </br>
                     </br>

                     <label for="hash_type">Hash type</label>
                     </br>
                     <select name="hash_type" id="hash_type">
                        {% for hash_type in hash_type_list %}
                        <option value="{{ hash_type.id }}">{{ hash_type.name }}</option>
                        {% endfor %}
                     </select>
                     </br>
                     </br>

                     <label for="mask">Mask</label>
                     </br>
                     <select name="mask" id="mask">
                        {% for mask in mask_list %}
                        <option value="{{ mask }}">{{ mask }}</option>
                        {% endfor %}
                     </select>
                     </br>
                     </br>

                     <label for="hashes">Hashes</label>
                     </br>
                     <textarea name="hashes" id="hashes" rows="10" cols="60"></textarea>

                     <input type="file" name="hash_file" size="40">

                     <input type="checkbox" name="username_included" value="username_included">Username included
                     <br>
                     <br>
                     <button type="submit" class="btn btn-primary" >Crack</button>
                     </form>

                  </div>

               </div>
            </div>

            <div class="modal-footer">
            </div>
       </div>
     </div>
   </div>


{% endblock %}
