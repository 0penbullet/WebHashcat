{% extends "base.html" %}

{% block content %}
   <div class="row">
      <div class="col-md-6">

         <div class="panel panel-success">
            <div class="panel-heading">
               <h2 class="panel-title">{{ node_name }}</h2>
            </div>
            <div class="panel-body">
               Hostname: {{ hostname }}<br/>
               Port: {{ port }}<br/>
               Hashcat version: {{ version }}<br/>
            </div>
         </div>

         <h3> Rules <button type="button" class="btn btn-xs" data-toggle="modal" data-target="#upload_rule">Upload</button></h3>
         <table class="table table-striped table-condensed">
            <tr>
               <td><b>Name</b></td>
            </tr>
            {% for rule in rule_list %}
            <tr>
               <td>{{ rule }}</td>
            </tr>
            {% endfor %}
         </table>

         <h3> Masks <button type="button" class="btn btn-xs" data-toggle="modal" data-target="#upload_mask">Upload</button></h3>
         <table class="table table-striped table-condensed">
            <tr>
               <td><b>Name</b></td>
            </tr>
            {% for mask in mask_list %}
            <tr>
               <td>{{ mask }}</td>
            </tr>
            {% endfor %}
         </table>

         <h3> Wordlists <button type="button" class="btn btn-xs" data-toggle="modal" data-target="#upload_wordlist">Upload</button></h3>
         <table class="table table-striped table-condensed">
            <tr>
               <td><b>Name</b></td>
            </tr>
            {% for wordlist in wordlist_list %}
            <tr>
               <td>{{ wordlist }}</td>
            </tr>
            {% endfor %}
         </table>

      </div>
      <div class="col-md-6">

         <h3> Hash Types</h3> 
         <table class="table table-striped table-condensed">
            <tr>
               <td><b>id</b></td>
               <td><b>Name</b></td>
               <td><b>Description</b></td>
            </tr>
            {% for hash_type in hash_type_list %}
            <tr>
               <td>{{ hash_type.id }}</td>
               <td>{{ hash_type.name }}</td>
               <td>{{ hash_type.description }}</td>
            </tr>
            {% endfor %}
         </table>

      </div>
   </div>

   <!-- Modal -->
   <div class="modal fade" id="upload_rule" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
     <div class="modal-dialog modal-lg" role="document">
       <div class="modal-content">
         <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
           <h4 class="modal-title" id="myModalLabel">Upload rule</h4>
         </div>

         <div class="modal-body">

            <form action="{% url "Hashcat:upload_rule" %}" enctype="multipart/form-data" method="post">
            {% csrf_token %}
            <input type="hidden" id="node" name="node" value="{{ node_name }}">

            <label for="name">Name</label>
            <input type="text" class="form-control" id="name" name="name">
            </br>
            <input type="file" name="file" size="40">
            </br>
            <button type="submit" class="btn btn-primary" >Upload</button>
            </form>
         </div>

         <div class="modal-footer">
         </div>
       </div>
     </div>
   </div>

   <!-- Modal -->
   <div class="modal fade" id="upload_mask" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
     <div class="modal-dialog modal-lg" role="document">
       <div class="modal-content">
         <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
           <h4 class="modal-title" id="myModalLabel">Upload mask</h4>
         </div>

         <div class="modal-body">

            <form action="{% url "Hashcat:upload_mask" %}" enctype="multipart/form-data" method="post">
            {% csrf_token %}
            <input type="hidden" id="node" name="node" value="{{ node_name }}">

            <label for="name">Name</label>
            <input type="text" class="form-control" id="name" name="name">
            </br>
            <input type="file" name="file" size="40">
            </br>
            <button type="submit" class="btn btn-primary" >Upload</button>
            </form>
         </div>

         <div class="modal-footer">
         </div>
       </div>
     </div>
   </div>

   <!-- Modal -->
   <div class="modal fade" id="upload_wordlist" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
     <div class="modal-dialog modal-lg" role="document">
       <div class="modal-content">
         <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
           <h4 class="modal-title" id="myModalLabel">Upload wordlist</h4>
         </div>

         <div class="modal-body">

            <form action="{% url "Hashcat:upload_wordlist" %}" enctype="multipart/form-data" method="post">
            {% csrf_token %}
            <input type="hidden" id="node" name="node" value="{{ node_name }}">

            <label for="name">Name</label>
            <input type="text" class="form-control" id="name" name="name">
            </br>
            <input type="file" name="file" size="40">
            </br>
            <button type="submit" class="btn btn-primary" >Upload</button>
            </form>
         </div>

         <div class="modal-footer">
         </div>
       </div>
     </div>
   </div>


{% endblock %}
